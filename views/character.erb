<h2>Character</h2>

<%= @character[:name] %>

<ul>
  <li>Created: <%= @character[:created_at] %></li>
  <li>Updated: <%= @character[:updated_at] %></li>
  <li>Gender: <%= gender(@character[:gender_id]) %></li>
  <li>Race: <%= race(@character[:race_id]) %></li>
  <li>Rank: <%= rank_name(@character[:race_id], @character[:gender_id], @character[:rank]) %> (<%= @character[:rank] %>)</li>
</ul>

<%= erb :_full_character if @character.strength_base %>

<h3>Chain</h3>
<div id="chain"></div>

<script src="/javascript/d3.min.js"></script>
<script src="/javascript/chain.js"></script>
<script>
  var tokens = window.location.href.split("/");
  var server_name = tokens.length == 5 ? tokens[tokens.length - 2] : null;
  var player_name = tokens.length == 5 ? decodeURIComponent(tokens[tokens.length - 1]) : null;
  var request_url =
        "/" +
        server_name + "/" +
        player_name + "/" +
        "chain";

  d3.json(request_url).then(function(data) {
    chain("#chain", data);
  });
</script>